<?xml version="1.0" ?>
<robot xmlns:xacro="http://ros.org/wiki/xacro">

  <xacro:include filename="materials.xacro"/>
  <xacro:include filename="inertial_macros.xacro"/>

  <!-- Robot's base properties -->
  <xacro:property name="base_length" value="0.27"/>
  <xacro:property name="base_width" value="0.145"/>
  <xacro:property name="base_height" value="0.085"/>

  <!-- Robot's wheel properties -->
  <xacro:property name="wheel_radius" value="0.03"/>
  <xacro:property name="wheel_height" value="0.045"/>
  <xacro:property name="wheel_mass" value="0.01"/>

  <!-- Distance between centre of wheel and robot base -->
  <xacro:property name="wheel_zoff" value="0.01"/>

  <!-- BASE_FOOTPRINT LINK -->

  <link name="base_footprint"/>

  <!-- CHASSIS LINK -->

<joint name="base_joint" type="fixed">
  <parent link="base_footprint"/>
  <child link="base_link"/>
</joint>

<link name="base_link">
  <visual>
    <origin xyz="0 0 0" rpy="0 0 0"/>
    <geometry>
      <mesh filename="package://raspitank_description/meshes/chassis.stl" scale="0.001 0.001 0.001"/>
    </geometry>
    <material name="silver"/>
  </visual>
  <collision>
    <origin xyz="0.087375 0 0.065" rpy="0 0 0"/>
    <geometry>
      <box size="${base_length} ${base_width} ${base_height}"/>
    </geometry>
  </collision>

  <xacro:box_inertia mass="1.0" length="${base_length}" width="${base_width}" height="${base_height}">
      <origin xyz="0.078 0 0.065" rpy="0 0 0"/>
    </xacro:box_inertia>
</link>

<gazebo reference="base_link">
    <material>Gazebo/White</material>
</gazebo>

<!-- LEFT BACK WHEEL -->

<!-- <joint name="left_wheel_joint" type="continuous">  
  <parent link="base_link"/>
  <child link="left_wheel"/>
  <origin xyz="-0.112746 0.07275 0.053" rpy="0 0 0"/>
  <axis xyz="0.0 1.0 0.0"/>
</joint> -->

<joint name="left_wheel_joint" type="continuous">  
  <parent link="base_link"/>
  <child link="left_wheel"/>
  <origin xyz="0.01 0.1 0.03" rpy="0 0 0"/>
  <axis xyz="0.0 1.0 0.0"/>
</joint>

<link name="left_wheel">
  <!-- <visual>
    <origin xyz="-0.112746 -0.07225 -0.053" rpy="0 0 ${pi}"/>
    <geometry>
      <mesh filename="package://raspitank_description/meshes/left_wheel.stl" scale="0.001 0.001 0.001"/>
    </geometry>
    <material name="black"/>
  </visual> -->
  <collision>
    <!-- <origin xyz="0.035 0.025 -0.025" rpy="0 0 0"/> -->
    <origin xyz="0 0 0" rpy="0 0 0"/>
    <geometry>
      <sphere radius="${wheel_radius}"/>
    </geometry>
  </collision>

  <xacro:cylinder_inertia mass="${wheel_mass}" length="${wheel_height}" radius="${wheel_radius}">
    <origin xyz="0 0 0" rpy="0 0 0"/>
  </xacro:cylinder_inertia>
</link>

<gazebo reference="left_wheel">
    <material>Gazebo/Black</material>
</gazebo>

<!-- RIGHT BACK WHEEL -->

<!-- <joint name="right_wheel_joint" type="continuous">
  <parent link="base_link"/>
  <child link="right_wheel"/>
  <origin xyz="-0.112746 -0.07225 0.053" rpy="0 0 0"/>
  <axis xyz="0.0 1.0 0.0"/>
</joint> -->

<joint name="right_wheel_joint" type="continuous">
  <parent link="base_link"/>
  <child link="right_wheel"/>
  <origin xyz="0.01 -0.1 0.03" rpy="0 0 0"/>
  <axis xyz="0.0 1.0 0.0"/>
</joint>

<link name="right_wheel">
  <!-- <visual>
    <origin xyz="-0.122746 -0.17275 -0.083" rpy="0 0 ${pi}"/>
    <geometry>
      <mesh filename="package://raspitank_description/meshes/right_wheel.stl" scale="0.001 0.001 0.001"/>
    </geometry>
    <material name="black"/>
  </visual> -->
  <collision>
    <origin xyz="0 0 0" rpy="0 0 0"/>
    <geometry>
      <sphere radius="${wheel_radius}"/>
    </geometry>
  </collision>

  <xacro:cylinder_inertia mass="${wheel_mass}" length="${wheel_height}" radius="${wheel_radius}">
    <origin xyz="0 0 0" rpy="0 0 0"/>
  </xacro:cylinder_inertia>
</link>

<gazebo reference="right_wheel">
    <material>Gazebo/Black</material>
</gazebo>

<!-- Caster wheel -->
  <link name="caster_wheel">
    <collision>
      <origin xyz="0.096 0 0.015" rpy="0 0 0"/>
      <geometry>
        <sphere radius="0.015"/>
      </geometry>
    </collision>

    <xacro:sphere_inertia mass="0.033" radius="0.025">
      <origin xyz="0.096 0 0.015" rpy="0 0 0"/>
    </xacro:sphere_inertia>
  </link>

  <joint name="caster_wheel_joint" type="fixed">
    <parent link="base_link"/>
    <child link="caster_wheel"/>
    <origin xyz="0.096 0 0" rpy="0 0 0"/>
  </joint>

  <gazebo reference="caster_wheel">
    <mu1 value="0.001"/>
    <mu2 value="0.001"/>
  </gazebo>

</robot>
